from . import db
from .metadata_mixin import MetaDataColumnsMixin


class VulnerabilityConfigurationInput(db.Model, MetaDataColumnsMixin):
    __tablename__ = 'vulnerabilityConfigurationInputs'

    vulnConfigId = db.Column(db.Integer, primary_key=True)
    vulnClass = db.Column(db.String(32), nullable=False)
    featureModelUid = db.Column(db.String(64), db.ForeignKey('feature_models.uid'), nullable=False)
    workflowId = db.Column(
        db.Integer,
        db.ForeignKey('workflows.workflowId', ondelete='CASCADE'),  # noqa E501
        nullable=False,
        comment='a vulnerability configuration input should always be associated with a workflow'
    )

    featureModel = db.relationship('FeatureModel')

    def __repr__(self):
        return f'<VulnerabilityConfigurationInput id="{self.vulnConfigId}" label="{self.label}">'
